/*
FilterASCII function

Author
*COMMENT Visual Realisation

Format
FilterASCII ( text ; extended )

Parameters
text - any text expression or text field
extended - 0 or False, 1 or True

Data type returned
text

Description
Removes characters from text, retaining only printable characters included in the American Standard Code for Information Interchange (US-ASCII) character set.

The following characters are passed by the filter:
• Horizontal Tab [9];
• Carriage Return [13];
• Space [32];
• Characters [33]..[126].

When the extended parameter is True(1), characters in the extended ASCII character set range [128]..[255] are also passed.

March 27, 2011
*/

Let ( 
filterText = 
GetAsURLEncoded ( text ) 
& 
Char ( 125001240012300096000940009200062000600003700034000930009100035000630004700044000360004300061000380006400058000590004100040000390004200033000320001300009 ) 

& Case ( extended ;
Char ( 191001900018900188001870018600185001840018300182001810018000179001780017700176001750017400173001720017100170001690016800167001660016500164001630016200161001600015900158001570015600155001540015300152001510015000149001480014700146001450014400143001420014100140001390013800137001360013500134001330013200131001300012900128 ) 
& 
Char ( 
255002540025300252002510025000249002480024700246002450024400243002420024100240002390023800237002360023500234002330023200231002300022900228002270022600225002240022300222002210022000219002180021700216002150021400213002120021100210002090020800207002060020500204002030020200201002000019900198001970019600195001940019300192 )
)
;
Filter ( text ; filterText )
)